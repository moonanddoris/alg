延伸：
如何保证 高并发下 消息的有序性

如果多线程进行生产和消费，必然会产生顺序错乱的问题

生产：有关联的数据 分配在同一个 partition中，如相同的订单id
消费：consumer接收到消息后，在内部划分不同的 内存队列，交到下游多线程进行处理

整体思路是，进行合理划分，有关联的数据 通过单线程进行处理，就可以保证有序性

关联 mongoDB的findAndModify
关联 redis是否单线程处理？



误解：volatile变量对所有线程是立即可见的，所以对volatile变量的所有修改(写操作)都立刻能反应到其他线程中。
或者换句话说：volatile变量在各个线程中是一致的，所以基于volatile变量的运算在并发下是线程安全的。
最后的结论是错误的。